// SHOW THE TOTAL COST FOR THE GIVEN ORDER

SELECT OrderDetails.OrderId, SUM (OrderDetails.Quantity * Products.Price) as "Total Order Cost" FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductId = Products.ProductId GROUP BY OrderDetails.OrderId;

// SHOW THE CUSTOMER NAME FOR THE GIVEN ORDER
SELECT Orders.OrderID, Customers.CustomerName FROM Orders INNER JOIN OrderDetails ON OrderDetails.OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY Orders.OrderID;

// SHOW THE TOTAL COST FOR THE GIVEN ORDER AND SHOW THE CUSTOMER ID
SELECT OrderDetails.OrderId, Orders.CustomerID, SUM (OrderDetails.Quantity * Products.Price) as Total FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductId = Products.ProductId INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderId GROUP BY OrderDetails.OrderId;

// SHOW THE TOTAL COST FOR THE GIVEN ORDER AND SHOW THE CUSTOMER NAME
SELECT OrderDetails.OrderId, Orders.CustomerID, Customers.CustomerName, SUM (OrderDetails.Quantity * Products.Price) as "Total Order Cost" FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductId = Products.ProductId INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderId INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY OrderDetails.OrderId;

// SHOW THE TOTAL AMOUNT SPENT BY A CUSTOMER FOR ALL TIME
SELECT CustomerID, CustomerName, SUM(TOTAL) AS "Total Amount Spent" FROM (SELECT Orders.CustomerID, Customers.CustomerName, SUM (OrderDetails.Quantity * Products.Price) as TOTAL FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductId = Products.ProductId INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderId INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY OrderDetails.OrderId) GROUP BY CustomerID;

// SHOW HOW MANY CUSTOMERS PER COUNTRY
SELECT COUNTRY, COUNT(COUNTRY) AS "CUSTOMERS IN THAT COUNTRY" FROM CUSTOMERS GROUP BY COUNTRY

// SHOW THE TOTAL AMOUNT OF MONEY COMING FROM CUSTOMERS FOR THE GIVEN COUNTRIES
SELECT Country, SUM(TOTAL) AS "Total $ Spent" FROM (SELECT Orders.CustomerID, Customers.Country, SUM (OrderDetails.Quantity * Products.Price) as TOTAL FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductId = Products.ProductId INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderId INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY OrderDetails.OrderId) GROUP BY COUNTRY;
