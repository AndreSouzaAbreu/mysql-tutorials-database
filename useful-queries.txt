// SHOW THE TOTAL COST FOR THE GIVEN ORDER
SELECT OrderDetails.OrderID, SUM(OrderDetails.Quantity * Products.Price) as "Total Order Cost" FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductID = Products.ProductID GROUP BY OrderDetails.OrderID;


// SHOW THE CUSTOMER NAME FOR THE GIVEN ORDER
SELECT Orders.OrderID, Customers.CustomerName FROM Orders INNER JOIN OrderDetails ON OrderDetails.OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY Orders.OrderID;


// SHOW THE TOTAL COST FOR THE GIVEN ORDER
SELECT OrderDetails.OrderID, Orders.CustomerID, SUM(OrderDetails.Quantity * Products.Price) as Total FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductID = Products.ProductID INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderId GROUP BY OrderDetails.OrderId;


// SHOW THE TOTAL COST FOR THE GIVEN ORDER
SELECT OrderDetails.OrderID, Orders.CustomerID, Customers.CustomerName, SUM(OrderDetails.Quantity * Products.Price) as "Total Order Cost" FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductID = Products.ProductID INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY OrderDetails.OrderID ORDER BY Orders.CustomerID;


// SHOW THE TOTAL AMOUNT SPENT BY A CUSTOMER
SELECT CustomerID, CustomerName, SUM(TOTAL) AS "Total amount spent" FROM (SELECT Orders.CustomerID, Customers.CustomerName, SUM(OrderDetails.Quantity * Products.Price) as TOTAL FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductID = Products.ProductID INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY OrderDetails.OrderID) GROUP BY CustomerID ORDER BY "Total amount spent" DESC;


// SHOW HOW MANY CUSTOMERS PER COUNTRY
SELECT Country, COUNT(Country) AS "Total Costumers" FROM Customers GROUP BY Country ORDER BY Country DESC;


// SHOW THE TOTAL SALES BY COUNTRY. USEFUL TO KNOW WHICH COUNTRIES SPEND MORE MONEY
SELECT Country, SUM(TOTAL) AS "Total sales" FROM (SELECT Orders.CustomerID, Customers.Country, SUM(OrderDetails.Quantity * Products.Price) as TOTAL FROM OrderDetails INNER JOIN Products ON OrderDetails.ProductID = Products.ProductID INNER JOIN Orders ON OrderDetails.OrderID = Orders.OrderID INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID GROUP BY OrderDetails.OrderID) AS CustomersOrdersPrice GROUP BY COUNTRY ORDER BY "Total sales" DESC;


// SHOW THE TOTAL SALES BY EMPLOYEE. USEFUL TO KNOW WHICH EMPLOYEE IS SAILING MORE.
SELECT Employee, SUM("ORDER PRICE") AS "Total Sales" FROM (SELECT Orders.OrderID, Employees.FirstName as Employee, SUM(OrderDetails.Quantity * Products.PRICE) AS "ORDER PRICE" FROM Orders INNER JOIN Employees ON Orders.EmployeeID = Employees.EmployeeID INNER JOIN OrderDetails ON OrderDetails.OrderID = Orders.OrderID INNER JOIN Products ON OrderDetails.ProductID = Products.ProductID GROUP BY Orders.OrderID) AS EmployeesSales GROUP BY Employee ORDER BY "Total Sales" DESC;


// SHOW THE HOW MANY PRODUCTS WERE SOLD FOR EACH PRODUCT. USEFUL TO KNOW WHICH PRODUCTS SELL MORE.
SELECT OrderDetails.ProductID, Products.ProductName, SUM(Quantity) AS "Quantity sold" FROM OrderDetails INNER JOIN Products ON Products.ProductID = OrderDetails.ProductID GROUP BY OrderDetails.ProductID ORDER BY "Sales in dollars" DESC;


// SHOW THE TOTAL SALES BY PRODUCT. USEFUL TO KNOW WHICH PRODUCTS MAKE MORE MONEY
SELECT OrderDetails.ProductID, Products.ProductName, SUM(Quantity) AS "Quantity sold", SUM(Quantity * Price) AS "Sales in dollars" From OrderDetails INNER JOIN Products ON Products.ProductID = OrderDetails.ProductID GROUP BY OrderDetails.ProductID ORDER BY "Sales in dollars" DESC;


// SHOW HOW MANY PRODUCTS WERE SOLD FOR EACH CATEGORY. USEFUL TO KNOW WHICH CATEGORIES SELL MORE PRODUCTS.
SELECT Categories.CategoryID, Categories.CategoryName, SUM("Product sales") AS "Total sales" FROM (SELECT OrderDetails.ProductID, Products.CategoryID, SUM(Quantity) AS "Product sales" From OrderDetails INNER JOIN Products ON Products.ProductID = OrderDetails.ProductID GROUP BY OrderDetails.ProductID) AS ProductsSales INNER JOIN Categories ON ProductsSales.CategoryID = Categories.CategoryID GROUP BY Categories.CategoryID;


// SHOW THE TOTAL SALES BY CATEGORY. USEFUL TO KNOW WHICH CATEGORIES MAKE MORE MONEY
SELECT Categories.CategoryID, Categories.CategoryName, SUM(Sales) AS "Total sales" FROM (SELECT OrderDetails.ProductID, CategoryID, SUM(Quantity * Price) AS "Sales" From OrderDetails INNER JOIN Products ON Products.ProductID = OrderDetails.ProductID GROUP BY OrderDetails.ProductID) AS ProductsSales INNER JOIN Categories ON ProductsSales.CategoryID = Categories.CategoryID GROUP BY ProductsSales.CategoryID ORDER BY "Total sales" DESC;